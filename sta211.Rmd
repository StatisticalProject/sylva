---
title: "Untitled"
output: github_document
---

Start
```{r}
 train.data <- read.table("data/sylva_train.data")
 train.labels <- read.table("data/sylva_train.labels")
 train.labels$V1 <- as.factor(train.labels$V1)
 colnames(train.labels)[1] <- "Y"
 train.full=(cbind(train.labels,train.data))
 table(train.labels)
 acp.train <- princomp(train.data, center = TRUE,scale. = TRUE)
 print (acp.train)
 plot( acp.train , type = "l")
 plot(1-cumsum(acp.train$sdev^2 / sum(acp.train$sdev^2)))
 print(1-cumsum(acp.train$sdev^2 / sum(acp.train$sdev^2))) 
 #statistiques descriptives
summary(train.data)

#dessine correlation
corMAt<-cor(train.data)
image(corMAt)
library(lattice)
levelplot(corMAt,aspect="iso",pretty=TRUE,xlim=c(1,199), ylim=c(1,199))

graphics.off()
par(mfrow=c(4,5))
nb<-ncol(train.data)
for (i in 1:nb){
  hist(train.data[,i],main = paste("Variable",i))

}

#grille de barchart
install.packages("gridExtra")
 require(gridExtra) # also loads grid
 require(lattice)
 x <- seq(pi/4, 5 * pi, length.out = 100)> y <- seq(pi/4, 5 * pi, length.out = 100)
 r <- as.vector(sqrt(outer(x^2, y^2, "+")))

 grid <- expand.grid(x=x, y=y)
 grid$z <- cos(r^2) * exp(-r/(pi^3))
 plot1 <- levelplot(z~x*y, grid, cuts = 50, scales=list(log="e"), xlab="",
           ylab="", main="Weird Function", sub="with log scales",
           colorkey = FALSE, region = TRUE)

 plot2 <- levelplot(z~x*y, grid, cuts = 50, scales=list(log="e"), xlab="",
           ylab="", main="Weird Function", sub="with log scales",
           colorkey = FALSE, region = TRUE)
 grid.arrange(plot1,plot2, ncol=2)

#nuages de points.
png("dp3_sa_para.png", 3096, 3096)
#pairs(train)
dev.off()
library(rpart)
fit <- rpart(Kyphosis ~ Age + Number + Start,
  	method="class", data=kyphosis)

printcp(fit) # display the results 
plotcp(fit) # visualize cross-validation results 
summary(fit) # detailed summary of splits

# plot tree 
plot(fit, uniform=TRUE, 
  	main="Classification Tree for Kyphosis")
text(fit, use.n=TRUE, all=TRUE, cex=.8)

# create attractive postscript plot of tree 
post(fit, file = "c:/tree.ps", 
  	title = "Classification Tree for Kyphosis")

library(randomForest)
iris.rf <- randomForest(Y ~ ., data=train.full, importance=TRUE,proximity=TRUE)
plot(iris.rf, log="y")
varImpPlot(iris.rf)
MDSplot(iris.rf, train.full$Y)
iris.p <- classCenter(train, labels, iris.rf$prox)
plot(iris[,3], iris[,4], pch=21, xlab=names(iris)[3], ylab=names(iris)[4],
bg=c("red", "blue", "green")[as.numeric(factor(iris$Species))],
main="Iris Data with Prototypes")
points(iris.p[,3], iris.p[,4], pch=21, cex=2, bg=c("red", "blue", "green"))
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## GitHub Documents

This is an R Markdown format used for publishing markdown documents to GitHub. When you click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated.

## Including Code

You can include R code in the document as follows:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
